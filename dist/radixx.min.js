/*!
  * @lib: Radixx
  * @version: 0.0.4
  * @author: Ifeora Okechukwu
  * @created: 30/12/2016
  *
  * All Rights Reserved 2016 - 2017.
  * Use, reproduction, distribution, and modification of this code is subject to the terms and
  * conditions of the MIT license, available at http://www.opensource.org/licenses/mit-license.php
  *
  * @desc: Implementation of Facebooks' Flux Architecture with a Twist.
  */
!function(n,t){var i="undefined";typeof module==i||!module.exports?typeof define==i||!define.amd?window.Radixx=t(n):define("Radixx",function(){return t(n)}):module.exports=t(n)}(this,function(n,t){var l=!1,f=!0,a="constructor",u="function",v="object",i=null;function e(){this.toString=function(){return"[object Hub]"}}var r={}.hasOwnProperty,o=[].slice,y=function(n,u,f){f===t&&(f=i);for(var e in n)r.call(n,e)&&u.call(f,n[e],e)},w=function(n,t,i){return function(){var r=o.call(arguments);return n.apply(i,t.concat(r))}};Array.prototype.forEach=Array.prototype.forEach||function(n,t){return y(this,n,t)},Function.prototype.bind=Function.prototype.bind||function(n){return w(this,[].slice(arguments,1),n)},Object.keys=Object.keys||function(n){var s="toString",t,f,h,e,i,o;if(typeof n==v||typeof n==u){t=[];for(f in fuc)r.call(fuc,f)&&t.push(f);if(h=!ob.propertyIsEnumerable(s),e=[s,"toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","prototypeIsEnumerable",a],h)for(i=0;i<e.length;i++)o=e[i],r.call(fuc,o)&&t.push(o);return t}};var b=function(){var n=["graph-ql"],t={};return function(n){var r=this,t=r;r.getTitle=function(){return n},r.toJSON=function(){return{title:n}},r.vuejs={__vue_update:i},r.vuejs.mixin={created:function(){var n=this;t.vuejs.__vue_update=function(t,i){try{n[i]=this.getState(i)}catch(r){}}},beforeMount:function(){t.setChangeListener(t.vuejs.__vue_update)},data:function(){return store.getState()},beforeDestroy:function(){t.unsetChangeListener(t.vuejs.__vue_update),t.disconnet(),t.destroy()}},r.reactjs={__react_update:i},r.reactjs.mixin={componentWillMount:function(){t.reactjs.__react_update=this.setState.bind(this,function(n){return n}),t.setChangeListener(t.reactjs.__react_update)},componentWillUnMount:function(){t.unsetChangeListener(t.reactjs.__react_update),t.disconnet(),t.destroy()},getDefaultProps:function(){return t.getState()}},r.toString=function(){return"[object RadixxStore]"}}}(),k=function(){return function(n){this.getId=function(){return n},this.toJSON=function(){return{id:n}},this.toString=function(){return"[object RadixxAction]"}}}(),s={STARTED:0,AWAIT:1,RESOLVED:2,REJECTED:3},d=function(n){var t={},i=String(n).split(",");return i.forEach(function(n){t[n]=f}),t.savedData=!1,t},p=function(n){var e=d(n),a,v,c,p,b,r=[],s=e.multiple&&[],h=function(n){for(e.savedData=!h.$decline&&e.save&&n,p=f,b=f,c=a||0,v=r.length,a=0;c<v;c++)setTimeout(w(r[c],n[1],n[0]),20);if(b=l,s&&s.length)return h(s.shift());h.$decline=l,e.savedData&&e.unpack&&(r.length=0)};return{add:function(){var n=0,t;return r&&(t=r.length,function i(t){t.forEach(function(t){var f=typeof t;f==u?n=r.push(t):!!t&&t.length&&typeof t!="string"&&i(o.call(t))})}(o.call(arguments)),p&&e.join&&(a=t,v=n,h.$decline=f,h(e.savedData),this.disable())),n},hasFn:function(n){var t=l;return y(r,function(i){typeof n==u&&n===i&&(t=f)},this),t},hasList:function(){return!!r},fireWith:function(){if(r&&(!p||s)){var n=arguments.length&&o.call(arguments)||[i,0];b?s.push(n):h(n)}},disable:function(){e.savedData||(r=s=t)}}},h=function(){var y="join",t={resolve:["done","RESOLVED",p([y,"save"])],reject:["fail","REJECTED",p([y,"save"])],notify:["progress","AWAIT",p([y,"multiple"])]},n=this,l=Object.keys(t),a=function(i,r,u){var e=i!="notify";return!r.length&&!u?t[i][2].fireWith:u?function(){return n.state>=0&&n.state<=1&&t[i][2].add.apply(n,o.call(arguments)),n}:function(){if(n.state>=0&&n.state<=1&&(n.state=s[t[i][1]]),t[i][2].fireWith(n===this?n:this,[].slice.call(arguments)),e){t[r[0]][2].disable(),t[r[1]][2].disable();switch(i){case"reject":case"resolve":n.state=s[t[i][1]]}}return f}},w=0,b=l.slice(),c,e={};for(c in t)r.call(t,c)&&(l.splice(w++,1),n[c]=a(c,l),n[c+"With"]=a(c,[]),e[t[c][0]]=a(c,[],f),l=b.slice());return e.state=s.STARTED,e.always=function(){return this.done.apply(n,arguments).fail.apply(n,arguments)},e.promise=function(n){if(n&&typeof n==v&&!n.length){for(var t in e)r.call(e,t)&&(n[t]=e[t]);return n}return e},e.then=function(){var i,r=[].slice.call(arguments);return r.forEach(function(r,f){r=typeof r==u&&r,n[t[l[f]][0]](function(){var n;try{n=r&&r.apply(this,arguments)}catch(t){n=this.reject(t)}finally{n&&typeof n.promise==u&&(i=n.promise())}})}),n.promise(i)},e.isResolved=function(){return!t.reject[2].hasList()},e.isRejected=function(){return!t.resolve[2].hasList()},e.pipe=e.then,e.promise(n),h.STARTED=s.STARTED,h.AWAITING=s.AWAIT,h.RESOLVED=s.RESOLVED,h.REJECTED=s.REJECTED,a=b=c=w=i,n instanceof h?n:new h},c=function(n){var at="swapCallback",st="getQuerySchema",lt="disconnect",ot="getState",ct="unsetChangeListener",ht="setChangeListener",tt="hydrate",ft="remainingSpace",et="storesignal";function s(){n.document.addEventListener?n.document.addEventListener(et,bt,l):n.document.attachEvent&&n.document.attachEvent("onstoresignal",bt)}var it=i,o=n.sessionStorage,kt=n.document.documentMode||0,d=[],c={},k=[],e={},w={},vt=[],g={},nt={},yt=function(n){var t="__proto__";if("getPrototypeOf"in Object)return Object.getPrototypeOf(n);if(t in n){if(!r.call(n,t))return n.__proto__}else if(a in n&&!r.call(n,a))return n.constructor.prototype;return n},p=function(n){return n===void 0},dt=function(n,t,r,u){var e,o="Event"in u?new Event(t):i,s=i;if(o===i&&("CustomEvent"in u&&!u.document.documentMode?new CustomEvent(t):u.document.createEventObject()),s=n[u.document.documentMode||u.document.execScript&&String(u.document.execScript).indexOf("native")>-1?"fireEvent":"dispatchEvent"],typeof r==v)for(e in r)({}).hasOwnProperty.call(r,e)&&(o[e]=r[e]);return s.apply(n,(u.attachEvent||{}).toString().indexOf("native")>-1?["on"+t,o]:[o]),f},pt=function(n,i,r,f){n.$$history.length!=1||n.$$initData||(n.$$initData=n.$$history[0]),n.$$history=n.$$history.slice(0,n.$$historyIndex+1);var e=l,o=this,s;if(typeof o==u?e=o(f,r.actionData):(f._aspect=r.actionKey,e=n.call(i,r,f)),typeof e=="boolean"||e==t){throw new TypeError("Radixx: Application State unavailable after signal to Dispatcher");return}s=n.$$history.push(e),n.$$historyIndex++,n.$$history.length>15&&n.$$history.unshift()},rt=function(t){if(p(t)||t==="null")return i;try{return n.JSON?JSON.parse(t):new Function("return "+t)()}catch(r){return String(t)}},ut=function(n){p(n)&&(n=i);try{return JSON.stringify(n)}catch(t){return String(n)}},gt=function(){for(var i={},t,n=0;n<o.length;n++)t=o.key(n),i[t]=rt(o.getItem(t));return i},b=function(t){var r=this;return r.put=function(i){var r,f,e=ft in o&&kt===8;e&&typeof o.begin==u&&o.begin();try{o.setItem(t,ut(i))}catch(s){t in nt&&nt[t]&&(r=n.name.indexOf(t),f=n.name.indexOf("|",r),n.name=n.name.replace(n.name.substring(r,f),"")),n.name===""?n.name=t+"="+ut(i)+"|":n.name+=t+"="+ut(i)+"|",nt[t]=1}return e&&typeof o.commit==u&&o.commit(),dt(n.document,et,{url:n.location.href,key:t,newValue:i,source:n,aspect:this._aspect},n),i},r.get=function(){var r,u,f;return nt[t]?(r=n.name.indexOf(t),u=n.name.indexOf("|",r),f=n.name.substring(r,u).split("="),rt(f[1])||i):rt(o.getItem(t))||i},r.del=function(){return o.removeItem(t)},r},wt=function(){var t=i,f=gt(),n,u;for(n in w)r.call(w,n)&&(t=w[n],t.isResolved()||t.resolve(),delete w[n]);vt.length=0;for(u in d)r.call(d,u)&&d[u].call(i,f)},bt=function(t){var r,f,u;if(t=t||n.event,ft in o&&t.source===i&&l,k.indexOf(t.key)>-1&&(r=t.key,!p(e[r])))for(f=e[r].$$store_listeners,u=0;u<f.length;u++)f[u].call(c[r],r,t.aspect)};return s.prototype.getRegistration=function(n){return r.call(e,n)?e[n]:{}},s.prototype.register=function(n,t,i){if(r.call(e,n)){if("$$history"in e[n]&&typeof t.$$history=="undefined"){if(!c[n]){throw new Error("Radixx: Cannot Overwrite existing store registration");return}t.$$history=e[n].$$history,t.$$historyIndex=e[n].$$historyIndex,t.$$store_listeners=e[n].$$store_listeners,e[n]=t}}else t.$$store_listeners=[],t.$$history=[!i?[]:i],t.$$historyIndex=0,e[n]=t,k.push(n);return f},s.prototype.watch=function(n){d.push(n)},s.prototype.setStoreListener=function(n,t){var i=n.getTitle();p(e[i])||typeof t==u&&(c[i]=n,e[i].$$store_listeners.push(t))},s.prototype.unsetStoreListener=function(n,t){var i=n.getTitle(),r;p(e[i])||typeof t==u&&(r=e[i].$$store_listeners.indexOf(t),e[i].$$store_listeners.splice(r,1))},s.prototype.signalUnique=function(t){if(n.setTimeout(wt,0),t.source==tt){var r=function(n,t){return n.put(t)};pt.apply(r,[e[t.target],i,t,new b(title)])}},s.prototype.signal=function(t){if(n.setTimeout(wt,0),t.source in g)for(var u in e)r.call(e,u)&&pt.apply(i,[e[u],this.queueing,t,new b(u)])},s.prototype.unregister=function(n){var t,u,r;p(e[n])||(t=e[n],u=c[n],t.$$store_listeners.length=0,t.$$store_listeners=i,t.$$historyIndex=i,t.$$history.length=0,t.$$history=i,delete e[n],t=i,delete c[n],u=i,r=k.indexOf(n),r!=-1&&k.splice(r,1))},s.prototype.queueing={await:function(n,t){for(var r=-1,e=n.length+r,f=i;++r<e;)f=vt.indexOf(n[r])>-1?w[n[r]]:w[n[r]]=new h,typeof t==u&&f.then(t)}},{getInstance:function(){return it===i&&(it=new s),it},eachStore:function(n,t,r){y(k,t.bind(r=[],c));var u=n,f=r.length-1,e=function(){var n;return f>=0?n=Boolean(u.call(i,r[f--],e)):(u=!0,n=u),n};return e()},setActionVectors:function(n,t){var e=yt(n),o=this.getInstance(),f=i,u;for(u in t)r.call(t,u)&&(f=t[u],e[u]=this.createActionInterface(o,f));return n},createStoreInterface:function(n,t){return function(){var u=this,r,e,o=arguments.length?arguments[0]:i,s,h,l;return t==ht?n.setStoreListener(u,o):t==ct?n.unsetStoreListener(u,o):t==ot?(e=new b(u.getTitle()),s=e.get(),e=i,s===e)?(r=n.getRegistration(u.getTitle()),r.$$history.length&&r.$$history[0]):typeof o=="string"&&o in s?s[o]:s:t=="destroy"?(h=u.getTitle(),h in c&&delete c[h],e=new b(u.getTitle()),e.del(),e=i):t==lt?n.unregister(u.getTitle()):t==tt?p(o)?void 0:n.signalUnique({source:t,target:u.getTitle(),actionData:o}):t==st?{}:t=="setQuerySchema"?f:t=="canUndo"?(r=n.getRegistration(u.getTitle()),r.$$historyIndex!=0):t==at?n.register(u.getTitle(),o):t=="canRedo"?(r=n.getRegistration(u.getTitle()),r.$$historyIndex!==r.$$history.length-1):t=="undo"?(r=n.getRegistration(u.getTitle()),e=new b(u.getTitle()),u.canUndo()&&(--r.$$historyIndex,e.put(r.$$history[r.$$historyIndex]),r=i,e=i),f):t=="redo"?(r=n.getRegistration(u.getTitle()),e=new b(u.getTitle()),u.canRedo()&&(++r.$$historyIndex,e.put(r.$$history[r.$$historyIndex]),r=i,e=i),f):void 0}},createActionInterface:function(n,t){return function(r,u){var f=this.getId();p(g[f])||g[f].actionTypes.push(t),n.signal({source:f,actionType:t,actionKey:u||i,actionData:r})}},watchDispatcher:function(n){var t=this.getInstance();t.watch(n)},configureDispatcher:function(){},registerAction:function(){var n=Math.random().toString(16).substr(2,13);return g[n]={actionTypes:[]},n},makeAggregator:function(){return{notifyAllStores:function(){}}},setStoreObserver:function(n,t,r){var o,f;if(typeof t!=u)return i;var h=yt(n),s=this.getInstance(),c=n.getTitle(),e=i;for(s.register(c,t,r),o=[ht,ct,ot,lt,st,"canRedo","canUndo",at,"undo","redo",tt,"destroy"],f=0;f<o.length;f++)e=o[f],h[e]=this.createStoreInterface(s,e)}}}(n);return e.prototype.constructor=e,e.prototype.config=function(n){c.configureDispatcher(n)},e.prototype.onDispatch=function(n){c.watchDispatcher(n)},e.prototype.requestAggregator=function(){return c.makeAggregator()},e.prototype.eachStore=function(n){return c.eachStore(n,function(n,t){this.push(n[t])},i)},e.prototype.createAction=function(n){function t(){k.apply(this,o.call(arguments))}var i=new t(c.registerAction());return c.setActionVectors(i,n)},e.prototype.createStore=function(n,t,i){function u(){b.apply(this,o.call(arguments))}var r=new u(n);return c.setStoreObserver(r,t,i),r},new e})